<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–§–µ—Ä–º–µ—Ä—Å–∫–∏–π —Å–∏–º—É–ª—è—Ç–æ—Ä: –°–∞–¥–æ–≤–æ–¥—Å—Ç–≤–æ –∏ —Ç–æ—Ä–≥–æ–≤–ª—è</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(to bottom right, #e6f7e6, #c2e9c2);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-bottom: 5px solid #4CAF50;
        }
        
        h1 {
            color: #2E7D32;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .subtitle {
            color: #666;
            font-size: 1.2rem;
        }
        
        .game-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
        }
        
        .panel {
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .stats-panel {
            grid-column: 1 / span 2;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        
        .stat {
            display: flex;
            align-items: center;
            padding: 10px 20px;
            background-color: #f1f8e9;
            border-radius: 10px;
            margin: 5px;
        }
        
        .stat i {
            font-size: 1.5rem;
            margin-right: 10px;
            color: #4CAF50;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #2E7D32;
        }
        
        .stat-label {
            margin-left: 5px;
            color: #666;
        }
        
        .farm-panel {
            min-height: 500px;
        }
        
        .farm-title {
            font-size: 1.5rem;
            color: #2E7D32;
            margin-bottom: 20px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0f2e0;
        }
        
        .farm-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .plot {
            aspect-ratio: 1;
            background-color: #f1f8e9;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid #c8e6c9;
            position: relative;
            overflow: hidden;
        }
        
        .plot:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
        }
        
        .plot.empty {
            background-color: #f1f8e9;
        }
        
        .plot.planted {
            background-color: #e8f5e9;
        }
        
        .plant-icon {
            font-size: 2.5rem;
            margin-bottom: 5px;
        }
        
        .plant-name {
            font-size: 0.9rem;
            text-align: center;
            font-weight: bold;
        }
        
        .growth-bar {
            width: 100%;
            height: 8px;
            background-color: #e0e0e0;
            border-radius: 4px;
            margin-top: 10px;
            overflow: hidden;
        }
        
        .growth-progress {
            height: 100%;
            background-color: #4CAF50;
            width: 0%;
            transition: width 0.5s;
        }
        
        .time-left {
            font-size: 0.8rem;
            color: #666;
            margin-top: 5px;
        }
        
        .market-panel {
            min-height: 500px;
        }
        
        .market-title {
            font-size: 1.5rem;
            color: #2E7D32;
            margin-bottom: 20px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0f2e0;
        }
        
        .market-items {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        .market-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 10px;
            border: 1px solid #e0e0e0;
            transition: all 0.3s;
        }
        
        .market-item:hover {
            background-color: #f1f8e9;
            transform: translateX(5px);
        }
        
        .market-item-icon {
            font-size: 2rem;
            margin-right: 15px;
            color: #4CAF50;
        }
        
        .market-item-info {
            flex: 1;
        }
        
        .market-item-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .market-item-price {
            color: #2E7D32;
            font-weight: bold;
        }
        
        .market-item-time {
            font-size: 0.9rem;
            color: #666;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
        }
        
        .btn-primary {
            background-color: #4CAF50;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #388E3C;
        }
        
        .btn-secondary {
            background-color: #FF9800;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #F57C00;
        }
        
        .btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        
        .upgrades-panel {
            grid-column: 1 / span 2;
            margin-top: 20px;
        }
        
        .upgrades-title {
            font-size: 1.5rem;
            color: #2E7D32;
            margin-bottom: 20px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0f2e0;
        }
        
        .upgrades-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .upgrade {
            display: flex;
            align-items: center;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 10px;
            border: 1px solid #e0e0e0;
        }
        
        .upgrade-icon {
            font-size: 2rem;
            margin-right: 15px;
            color: #2196F3;
        }
        
        .upgrade-info {
            flex: 1;
        }
        
        .upgrade-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .upgrade-desc {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 10px;
        }
        
        .upgrade-price {
            color: #2196F3;
            font-weight: bold;
        }
        
        .messages {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 300px;
            z-index: 100;
        }
        
        .message {
            background-color: #4CAF50;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            animation: slideIn 0.5s, fadeOut 0.5s 2.5s forwards;
        }
        
        .message.error {
            background-color: #f44336;
        }
        
        .message.info {
            background-color: #2196F3;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeOut {
            to { opacity: 0; transform: translateY(-20px); }
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .modal-title {
            font-size: 1.8rem;
            color: #2E7D32;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .plants-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .plant-option {
            padding: 15px;
            background-color: #f1f8e9;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .plant-option:hover {
            background-color: #e8f5e9;
            border-color: #4CAF50;
        }
        
        .plant-option-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: #4CAF50;
        }
        
        .plant-option-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .plant-option-price {
            color: #2E7D32;
            font-weight: bold;
        }
        
        .plant-option-time {
            font-size: 0.9rem;
            color: #666;
        }
        
        @media (max-width: 900px) {
            .game-container {
                grid-template-columns: 1fr;
            }
            
            .stats-panel {
                grid-column: 1;
            }
            
            .upgrades-panel {
                grid-column: 1;
            }
            
            .farm-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 600px) {
            .farm-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .stats-panel {
                flex-direction: column;
            }
            
            .stat {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-tractor"></i> –§–µ—Ä–º–µ—Ä—Å–∫–∏–π —Å–∏–º—É–ª—è—Ç–æ—Ä</h1>
            <p class="subtitle">–í—ã—Ä–∞—â–∏–≤–∞–π—Ç–µ —Ä–∞—Å—Ç–µ–Ω–∏—è, –ø—Ä–æ–¥–∞–≤–∞–π—Ç–µ —É—Ä–æ–∂–∞–π –∏ —É–ª—É—á—à–∞–π—Ç–µ —Å–≤–æ—é —Ñ–µ—Ä–º—É!</p>
        </header>
        
        <div class="stats-panel panel">
            <div class="stat">
                <i class="fas fa-coins"></i>
                <span class="stat-value" id="money">100</span>
                <span class="stat-label">–º–æ–Ω–µ—Ç</span>
            </div>
            <div class="stat">
                <i class="fas fa-seedling"></i>
                <span class="stat-value" id="seeds">10</span>
                <span class="stat-label">—Å–µ–º—è–Ω</span>
            </div>
            <div class="stat">
                <i class="fas fa-chart-line"></i>
                <span class="stat-value" id="level">1</span>
                <span class="stat-label">—É—Ä–æ–≤–µ–Ω—å</span>
            </div>
            <div class="stat">
                <i class="fas fa-expand-arrows-alt"></i>
                <span class="stat-value" id="plots">4</span>
                <span class="stat-label">–≥—Ä—è–¥–æ–∫</span>
            </div>
        </div>
        
        <div class="game-container">
            <div class="farm-panel panel">
                <h2 class="farm-title"><i class="fas fa-tree"></i> –í–∞—à–∞ —Ñ–µ—Ä–º–∞</h2>
                <div class="farm-grid" id="farm-grid">
                    <!-- –ì—Ä—è–¥–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                </div>
                <div style="text-align: center;">
                    <button class="btn btn-primary" id="plant-btn">–ü–æ—Å–∞–¥–∏—Ç—å —Ä–∞—Å—Ç–µ–Ω–∏–µ</button>
                    <button class="btn btn-secondary" id="harvest-all-btn">–°–æ–±—Ä–∞—Ç—å –≤–µ—Å—å —É—Ä–æ–∂–∞–π</button>
                </div>
            </div>
            
            <div class="market-panel panel">
                <h2 class="market-title"><i class="fas fa-store"></i> –†—ã–Ω–æ–∫</h2>
                <div class="market-items" id="market-items">
                    <!-- –¢–æ–≤–∞—Ä—ã —Ä—ã–Ω–∫–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn btn-primary" id="sell-all-btn">–ü—Ä–æ–¥–∞—Ç—å –≤–µ—Å—å —É—Ä–æ–∂–∞–π</button>
                </div>
            </div>
            
            <div class="upgrades-panel panel">
                <h2 class="upgrades-title"><i class="fas fa-tools"></i> –£–ª—É—á—à–µ–Ω–∏—è</h2>
                <div class="upgrades-grid" id="upgrades-grid">
                    <!-- –£–ª—É—á—à–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø–æ—Å–∞–¥–∫–∏ —Ä–∞—Å—Ç–µ–Ω–∏–π -->
    <div class="modal" id="plant-modal">
        <div class="modal-content">
            <h2 class="modal-title">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞—Å—Ç–µ–Ω–∏–µ –¥–ª—è –ø–æ—Å–∞–¥–∫–∏</h2>
            <div class="plants-grid" id="plants-grid">
                <!-- –û–ø—Ü–∏–∏ —Ä–∞—Å—Ç–µ–Ω–∏–π –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-secondary" id="close-modal-btn">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>
    
    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π -->
    <div class="messages" id="messages-container"></div>
    
    <script>
        // –ò–≥—Ä–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        const gameState = {
            money: 100,
            seeds: 10,
            level: 1,
            experience: 0,
            plots: 4,
            maxPlots: 12,
            plants: [],
            upgrades: []
        };

        // –¢–∏–ø—ã —Ä–∞—Å—Ç–µ–Ω–∏–π
        const plantTypes = [
            { id: 1, name: "–ú–æ—Ä–∫–æ–≤—å", icon: "ü•ï", price: 10, growTime: 10, sellPrice: 20, seedsCost: 2 },
            { id: 2, name: "–ü—à–µ–Ω–∏—Ü–∞", icon: "üåæ", price: 15, growTime: 15, sellPrice: 30, seedsCost: 3 },
            { id: 3, name: "–ö—É–∫—É—Ä—É–∑–∞", icon: "üåΩ", price: 25, growTime: 20, sellPrice: 50, seedsCost: 5 },
            { id: 4, name: "–ü–æ–º–∏–¥–æ—Ä", icon: "üçÖ", price: 30, growTime: 25, sellPrice: 65, seedsCost: 6 },
            { id: 5, name: "–ö–ª—É–±–Ω–∏–∫–∞", icon: "üçì", price: 40, growTime: 30, sellPrice: 85, seedsCost: 8 },
            { id: 6, name: "–í–∏–Ω–æ–≥—Ä–∞–¥", icon: "üçá", price: 60, growTime: 40, sellPrice: 130, seedsCost: 12 }
        ];

        // –£–ª—É—á—à–µ–Ω–∏—è
        const upgrades = [
            { id: 1, name: "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –≥—Ä—è–¥–∫–∞", icon: "ü™¥", description: "–î–æ–±–∞–≤–ª—è–µ—Ç –æ–¥–Ω—É –≥—Ä—è–¥–∫—É –¥–ª—è –ø–æ—Å–∞–¥–∫–∏ —Ä–∞—Å—Ç–µ–Ω–∏–π", price: 100, effect: "addPlot" },
            { id: 2, name: "–£–ª—É—á—à–µ–Ω–Ω—ã–µ —Å–µ–º–µ–Ω–∞", icon: "üå±", description: "–£–º–µ–Ω—å—à–∞–µ—Ç –≤—Ä–µ–º—è —Ä–æ—Å—Ç–∞ —Ä–∞—Å—Ç–µ–Ω–∏–π –Ω–∞ 10%", price: 200, effect: "fasterGrowth", level: 1 },
            { id: 3, name: "–£–¥–æ–±—Ä–µ–Ω–∏–µ", icon: "üß™", description: "–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–æ–¥–∞–∂–∏ —Ä–∞—Å—Ç–µ–Ω–∏–π –Ω–∞ 15%", price: 300, effect: "betterPrice", level: 1 },
            { id: 4, name: "–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–∏–≤–∞", icon: "üíß", description: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª–∏–≤–∞–µ—Ç —Ä–∞—Å—Ç–µ–Ω–∏—è", price: 500, effect: "autoWater" },
            { id: 5, name: "–¢–µ–ø–ª–∏—Ü–∞", icon: "üè≠", description: "–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –¥–æ—Ö–æ–¥ –æ—Ç –ø—Ä–æ–¥–∞–∂–∏ –Ω–∞ 25%", price: 800, effect: "greenhouse" }
        ];

        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–π
        let selectedPlot = null;
        let gameInterval = null;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            loadGame();
            renderFarm();
            renderMarket();
            renderUpgrades();
            updateStats();
            
            // –ó–∞–ø—É—Å–∫ –∏–≥—Ä–æ–≤–æ–≥–æ —Ü–∏–∫–ª–∞
            gameInterval = setInterval(gameLoop, 1000);
            
            // –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
            document.getElementById('plant-btn').addEventListener('click', openPlantModal);
            document.getElementById('close-modal-btn').addEventListener('click', closePlantModal);
            document.getElementById('sell-all-btn').addEventListener('click', sellAllCrops);
            document.getElementById('harvest-all-btn').addEventListener('click', harvestAllCrops);
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            window.addEventListener('beforeunload', saveGame);
            
            showMessage("–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ –≤–∞—à—É —Ñ–µ—Ä–º—É! –ù–∞—á–Ω–∏—Ç–µ —Å –ø–æ—Å–∞–¥–∫–∏ –º–æ—Ä–∫–æ–≤–∏ –Ω–∞ –ø—É—Å—Ç—ã—Ö –≥—Ä—è–¥–∫–∞—Ö.", "info");
        }

        // –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
        function gameLoop() {
            updatePlants();
            updateStats();
            saveGame();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Ç–µ–Ω–∏–π
        function updatePlants() {
            const now = Date.now();
            let updated = false;
            
            gameState.plants.forEach(plant => {
                if (plant.plantedAt && !plant.ready) {
                    const elapsed = (now - plant.plantedAt) / 1000; // –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
                    const growTime = plant.growTime * (gameState.upgrades.includes(2) ? 0.9 : 1);
                    
                    if (elapsed >= growTime) {
                        plant.ready = true;
                        plant.progress = 100;
                        updated = true;
                    } else {
                        plant.progress = (elapsed / growTime) * 100;
                        plant.timeLeft = Math.ceil(growTime - elapsed);
                    }
                }
            });
            
            if (updated) {
                renderFarm();
            }
        }

        // –†–µ–Ω–¥–µ—Ä —Ñ–µ—Ä–º—ã
        function renderFarm() {
            const farmGrid = document.getElementById('farm-grid');
            farmGrid.innerHTML = '';
            
            // –°–æ–∑–¥–∞–µ–º –≥—Ä—è–¥–∫–∏
            for (let i = 0; i < gameState.plots; i++) {
                const plot = document.createElement('div');
                plot.className = 'plot';
                plot.dataset.index = i;
                
                const plant = gameState.plants[i];
                
                if (plant) {
                    plot.classList.add('planted');
                    
                    const plantType = plantTypes.find(p => p.id === plant.typeId);
                    
                    let plotContent = '';
                    plotContent += `<div class="plant-icon">${plantType.icon}</div>`;
                    plotContent += `<div class="plant-name">${plantType.name}</div>`;
                    
                    if (!plant.ready) {
                        plotContent += `<div class="growth-bar"><div class="growth-progress" style="width: ${plant.progress}%"></div></div>`;
                        plotContent += `<div class="time-left">${plant.timeLeft} —Å–µ–∫</div>`;
                    } else {
                        plotContent += `<div class="time-left" style="color: #4CAF50; font-weight: bold;">–ì–æ—Ç–æ–≤–æ –∫ —Å–±–æ—Ä—É!</div>`;
                    }
                    
                    plot.innerHTML = plotContent;
                    plot.addEventListener('click', () => harvestCrop(i));
                } else {
                    plot.classList.add('empty');
                    plot.innerHTML = `<div class="plant-icon">ü™¥</div><div class="plant-name">–ü—É—Å—Ç–∞—è –≥—Ä—è–¥–∫–∞</div>`;
                    plot.addEventListener('click', () => selectPlot(i));
                }
                
                farmGrid.appendChild(plot);
            }
        }

        // –†–µ–Ω–¥–µ—Ä —Ä—ã–Ω–∫–∞
        function renderMarket() {
            const marketItems = document.getElementById('market-items');
            marketItems.innerHTML = '';
            
            plantTypes.forEach(plant => {
                const sellPrice = calculateSellPrice(plant.sellPrice);
                
                const item = document.createElement('div');
                item.className = 'market-item';
                item.innerHTML = `
                    <div class="market-item-icon">${plant.icon}</div>
                    <div class="market-item-info">
                        <div class="market-item-name">${plant.name}</div>
                        <div class="market-item-price">–¶–µ–Ω–∞: ${sellPrice} –º–æ–Ω–µ—Ç</div>
                        <div class="market-item-time">–í—Ä–µ–º—è —Ä–æ—Å—Ç–∞: ${plant.growTime} —Å–µ–∫</div>
                    </div>
                `;
                marketItems.appendChild(item);
            });
        }

        // –†–µ–Ω–¥–µ—Ä —É–ª—É—á—à–µ–Ω–∏–π
        function renderUpgrades() {
            const upgradesGrid = document.getElementById('upgrades-grid');
            upgradesGrid.innerHTML = '';
            
            upgrades.forEach(upgrade => {
                const owned = gameState.upgrades.includes(upgrade.id);
                const canAfford = gameState.money >= upgrade.price;
                
                const upgradeElement = document.createElement('div');
                upgradeElement.className = 'upgrade';
                upgradeElement.innerHTML = `
                    <div class="upgrade-icon">${upgrade.icon}</div>
                    <div class="upgrade-info">
                        <div class="upgrade-name">${upgrade.name}</div>
                        <div class="upgrade-desc">${upgrade.description}</div>
                        <div class="upgrade-price">–¶–µ–Ω–∞: ${upgrade.price} –º–æ–Ω–µ—Ç</div>
                    </div>
                    <button class="btn ${owned ? 'btn-secondary' : 'btn-primary'}" ${owned || !canAfford ? 'disabled' : ''} 
                            data-upgrade-id="${upgrade.id}">
                        ${owned ? '–ö—É–ø–ª–µ–Ω–æ' : '–ö—É–ø–∏—Ç—å'}
                    </button>
                `;
                
                upgradesGrid.appendChild(upgradeElement);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É –ø–æ–∫—É–ø–∫–∏
                const buyBtn = upgradeElement.querySelector('button');
                if (!owned) {
                    buyBtn.addEventListener('click', () => buyUpgrade(upgrade.id));
                }
            });
        }

        // –í—ã–±–æ—Ä –≥—Ä—è–¥–∫–∏ –¥–ª—è –ø–æ—Å–∞–¥–∫–∏
        function selectPlot(index) {
            selectedPlot = index;
            openPlantModal();
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ—Å–∞–¥–∫–∏
        function openPlantModal() {
            // –ï—Å–ª–∏ –Ω–µ –≤—ã–±—Ä–∞–Ω–∞ –≥—Ä—è–¥–∫–∞, –≤—ã–±–∏—Ä–∞–µ–º –ø–µ—Ä–≤—É—é –ø—É—Å—Ç—É—é
            if (selectedPlot === null) {
                for (let i = 0; i < gameState.plots; i++) {
                    if (!gameState.plants[i]) {
                        selectedPlot = i;
                        break;
                    }
                }
                
                // –ï—Å–ª–∏ –≤—Å–µ –≥—Ä—è–¥–∫–∏ –∑–∞–Ω—è—Ç—ã
                if (selectedPlot === null) {
                    showMessage("–í—Å–µ –≥—Ä—è–¥–∫–∏ –∑–∞–Ω—è—Ç—ã! –°–æ–±–µ—Ä–∏—Ç–µ —É—Ä–æ–∂–∞–π –∏–ª–∏ –∫—É–ø–∏—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≥—Ä—è–¥–∫–∏.", "error");
                    return;
                }
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—ã–±—Ä–∞–Ω–Ω–∞—è –≥—Ä—è–¥–∫–∞ –ø—É—Å—Ç–∞
            if (gameState.plants[selectedPlot]) {
                showMessage("–≠—Ç–∞ –≥—Ä—è–¥–∫–∞ —É–∂–µ –∑–∞–Ω—è—Ç–∞! –í—ã–±–µ—Ä–∏—Ç–µ –ø—É—Å—Ç—É—é –≥—Ä—è–¥–∫—É.", "error");
                selectedPlot = null;
                return;
            }
            
            const modal = document.getElementById('plant-modal');
            const plantsGrid = document.getElementById('plants-grid');
            plantsGrid.innerHTML = '';
            
            // –°–æ–∑–¥–∞–µ–º –æ–ø—Ü–∏–∏ –¥–ª—è –ø–æ—Å–∞–¥–∫–∏
            plantTypes.forEach(plant => {
                const canAfford = gameState.seeds >= plant.seedsCost;
                
                const plantOption = document.createElement('div');
                plantOption.className = 'plant-option';
                plantOption.style.opacity = canAfford ? 1 : 0.6;
                plantOption.innerHTML = `
                    <div class="plant-option-icon">${plant.icon}</div>
                    <div class="plant-option-name">${plant.name}</div>
                    <div class="plant-option-price">–°–µ–º—è–Ω –Ω—É–∂–Ω–æ: ${plant.seedsCost}</div>
                    <div class="plant-option-time">–†–∞—Å—Ç–µ—Ç: ${plant.growTime} —Å–µ–∫</div>
                `;
                
                if (canAfford) {
                    plantOption.addEventListener('click', () => plantCrop(plant.id));
                } else {
                    plantOption.addEventListener('click', () => {
                        showMessage(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–µ–º—è–Ω –¥–ª—è –ø–æ—Å–∞–¥–∫–∏ ${plant.name}! –ù—É–∂–Ω–æ ${plant.seedsCost} —Å–µ–º—è–Ω.`, "error");
                    });
                }
                
                plantsGrid.appendChild(plantOption);
            });
            
            modal.style.display = 'flex';
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function closePlantModal() {
            const modal = document.getElementById('plant-modal');
            modal.style.display = 'none';
            selectedPlot = null;
        }

        // –ü–æ—Å–∞–¥–∫–∞ —Ä–∞—Å—Ç–µ–Ω–∏—è
        function plantCrop(plantTypeId) {
            const plantType = plantTypes.find(p => p.id === plantTypeId);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ —Å–µ–º—è–Ω
            if (gameState.seeds < plantType.seedsCost) {
                showMessage(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–µ–º—è–Ω! –ù—É–∂–Ω–æ ${plantType.seedsCost} —Å–µ–º—è–Ω.`, "error");
                return;
            }
            
            // –°–æ–∑–¥–∞–µ–º —Ä–∞—Å—Ç–µ–Ω–∏–µ
            gameState.plants[selectedPlot] = {
                typeId: plantTypeId,
                plantedAt: Date.now(),
                ready: false,
                progress: 0,
                timeLeft: plantType.growTime
            };
            
            // –í—ã—á–∏—Ç–∞–µ–º —Å–µ–º–µ–Ω–∞
            gameState.seeds -= plantType.seedsCost;
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            closePlantModal();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            renderFarm();
            updateStats();
            
            showMessage(`–í—ã –ø–æ—Å–∞–¥–∏–ª–∏ ${plantType.name}! –£—Ä–æ–∂–∞–π –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤ —á–µ—Ä–µ–∑ ${plantType.growTime} —Å–µ–∫—É–Ω–¥.`, "info");
        }

        // –°–±–æ—Ä —É—Ä–æ–∂–∞—è —Å –æ–¥–Ω–æ–π –≥—Ä—è–¥–∫–∏
        function harvestCrop(plotIndex) {
            const plant = gameState.plants[plotIndex];
            
            if (!plant) {
                showMessage("–ù–∞ —ç—Ç–æ–π –≥—Ä—è–¥–∫–µ –Ω–∏—á–µ–≥–æ –Ω–µ —Ä–∞—Å—Ç–µ—Ç!", "error");
                return;
            }
            
            if (!plant.ready) {
                showMessage("–†–∞—Å—Ç–µ–Ω–∏–µ –µ—â–µ –Ω–µ –≤—ã—Ä–æ—Å–ª–æ! –ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ–º–Ω–æ–≥–æ.", "error");
                return;
            }
            
            const plantType = plantTypes.find(p => p.id === plant.typeId);
            const sellPrice = calculateSellPrice(plantType.sellPrice);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –¥–µ–Ω—å–≥–∏
            gameState.money += sellPrice;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–ø—ã—Ç
            gameState.experience += 5;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Ä–æ–≤–µ–Ω—å
            checkLevelUp();
            
            // –£–¥–∞–ª—è–µ–º —Ä–∞—Å—Ç–µ–Ω–∏–µ
            gameState.plants[plotIndex] = null;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            renderFarm();
            updateStats();
            
            showMessage(`–í—ã —Å–æ–±—Ä–∞–ª–∏ ${plantType.name} –∏ –ø—Ä–æ–¥–∞–ª–∏ –µ–≥–æ –∑–∞ ${sellPrice} –º–æ–Ω–µ—Ç!`, "info");
        }

        // –°–±–æ—Ä –≤—Å–µ–≥–æ —É—Ä–æ–∂–∞—è
        function harvestAllCrops() {
            let harvested = 0;
            
            for (let i = 0; i < gameState.plots; i++) {
                const plant = gameState.plants[i];
                
                if (plant && plant.ready) {
                    const plantType = plantTypes.find(p => p.id === plant.typeId);
                    const sellPrice = calculateSellPrice(plantType.sellPrice);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –¥–µ–Ω—å–≥–∏
                    gameState.money += sellPrice;
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –æ–ø—ã—Ç
                    gameState.experience += 5;
                    
                    // –£–¥–∞–ª—è–µ–º —Ä–∞—Å—Ç–µ–Ω–∏–µ
                    gameState.plants[i] = null;
                    
                    harvested++;
                }
            }
            
            if (harvested === 0) {
                showMessage("–ù–µ—Ç –≥–æ—Ç–æ–≤—ã—Ö –∫ —Å–±–æ—Ä—É —Ä–∞—Å—Ç–µ–Ω–∏–π!", "error");
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Ä–æ–≤–µ–Ω—å
            checkLevelUp();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            renderFarm();
            updateStats();
            
            showMessage(`–í—ã —Å–æ–±—Ä–∞–ª–∏ ${harvested} —Ä–∞—Å—Ç–µ–Ω–∏–π –∏ –ø—Ä–æ–¥–∞–ª–∏ —É—Ä–æ–∂–∞–π!`, "info");
        }

        // –ü—Ä–æ–¥–∞–∂–∞ –≤—Å–µ–≥–æ —É—Ä–æ–∂–∞—è (—Å–±–æ—Ä + –ø—Ä–æ–¥–∞–∂–∞)
        function sellAllCrops() {
            harvestAllCrops();
        }

        // –ü–æ–∫—É–ø–∫–∞ —É–ª—É—á—à–µ–Ω–∏—è
        function buyUpgrade(upgradeId) {
            const upgrade = upgrades.find(u => u.id === upgradeId);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ –¥–µ–Ω–µ–≥
            if (gameState.money < upgrade.price) {
                showMessage(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥ –¥–ª—è –ø–æ–∫—É–ø–∫–∏ "${upgrade.name}"! –ù—É–∂–Ω–æ ${upgrade.price} –º–æ–Ω–µ—Ç.`, "error");
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∫—É–ø–ª–µ–Ω–æ –ª–∏ —É–∂–µ —É–ª—É—á—à–µ–Ω–∏–µ
            if (gameState.upgrades.includes(upgradeId)) {
                showMessage(`–£–ª—É—á—à–µ–Ω–∏–µ "${upgrade.name}" —É–∂–µ –∫—É–ø–ª–µ–Ω–æ!`, "error");
                return;
            }
            
            // –í—ã—á–∏—Ç–∞–µ–º –¥–µ–Ω—å–≥–∏
            gameState.money -= upgrade.price;
            
            // –î–æ–±–∞–≤–ª—è–µ–º —É–ª—É—á—à–µ–Ω–∏–µ
            gameState.upgrades.push(upgradeId);
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç —É–ª—É—á—à–µ–Ω–∏—è
            applyUpgradeEffect(upgrade);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            updateStats();
            renderUpgrades();
            
            showMessage(`–í—ã –∫—É–ø–∏–ª–∏ —É–ª—É—á—à–µ–Ω–∏–µ "${upgrade.name}"!`, "info");
        }

        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞ —É–ª—É—á—à–µ–Ω–∏—è
        function applyUpgradeEffect(upgrade) {
            switch (upgrade.effect) {
                case 'addPlot':
                    if (gameState.plots < gameState.maxPlots) {
                        gameState.plots++;
                        renderFarm();
                    }
                    break;
                case 'fasterGrowth':
                    // –≠—Ñ—Ñ–µ–∫—Ç —É–∂–µ —É—á—Ç–µ–Ω –≤ —Ä–∞—Å—á–µ—Ç–µ –≤—Ä–µ–º–µ–Ω–∏ —Ä–æ—Å—Ç–∞
                    break;
                case 'betterPrice':
                    // –≠—Ñ—Ñ–µ–∫—Ç —É–∂–µ —É—á—Ç–µ–Ω –≤ —Ä–∞—Å—á–µ—Ç–µ —Ü–µ–Ω—ã –ø—Ä–æ–¥–∞–∂–∏
                    break;
                case 'autoWater':
                    showMessage("–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–∏–≤–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª–∏–≤–∞–µ—Ç –≤–∞—à–∏ —Ä–∞—Å—Ç–µ–Ω–∏—è!", "info");
                    break;
                case 'greenhouse':
                    showMessage("–¢–µ–ø–ª–∏—Ü–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –¥–æ—Ö–æ–¥ –æ—Ç –ø—Ä–æ–¥–∞–∂–∏ —Ä–∞—Å—Ç–µ–Ω–∏–π!", "info");
                    break;
            }
        }

        // –†–∞—Å—á–µ—Ç —Ü–µ–Ω—ã –ø—Ä–æ–¥–∞–∂–∏ —Å —É—á–µ—Ç–æ–º —É–ª—É—á—à–µ–Ω–∏–π
        function calculateSellPrice(basePrice) {
            let multiplier = 1;
            
            // –£–ª—É—á—à–µ–Ω–∏–µ "–£–¥–æ–±—Ä–µ–Ω–∏–µ"
            if (gameState.upgrades.includes(3)) {
                multiplier += 0.15;
            }
            
            // –£–ª—É—á—à–µ–Ω–∏–µ "–¢–µ–ø–ª–∏—Ü–∞"
            if (gameState.upgrades.includes(5)) {
                multiplier += 0.25;
            }
            
            return Math.floor(basePrice * multiplier);
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è
        function checkLevelUp() {
            const expNeeded = gameState.level * 50;
            
            if (gameState.experience >= expNeeded) {
                gameState.level++;
                gameState.experience = 0;
                gameState.seeds += gameState.level * 5; // –ù–∞–≥—Ä–∞–¥–∞ –∑–∞ —É—Ä–æ–≤–µ–Ω—å
                
                showMessage(`–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ ${gameState.level} —É—Ä–æ–≤–Ω—è! –ü–æ–ª—É—á–µ–Ω–æ ${gameState.level * 5} —Å–µ–º—è–Ω.`, "info");
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats() {
            document.getElementById('money').textContent = gameState.money;
            document.getElementById('seeds').textContent = gameState.seeds;
            document.getElementById('level').textContent = gameState.level;
            document.getElementById('plots').textContent = `${gameState.plots}/${gameState.maxPlots}`;
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
        function showMessage(text, type = "info") {
            const messagesContainer = document.getElementById('messages-container');
            
            const message = document.createElement('div');
            message.className = `message ${type}`;
            message.textContent = text;
            
            messagesContainer.appendChild(message);
            
            // –£–¥–∞–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                message.remove();
            }, 3000);
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–≥—Ä—ã
        function saveGame() {
            const saveData = {
                ...gameState,
                plants: gameState.plants.map(plant => {
                    if (!plant) return null;
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ
                    return {
                        typeId: plant.typeId,
                        plantedAt: plant.plantedAt,
                        ready: plant.ready,
                        progress: plant.progress,
                        timeLeft: plant.timeLeft
                    };
                })
            };
            
            localStorage.setItem('farmSimulatorSave', JSON.stringify(saveData));
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä—ã
        function loadGame() {
            const savedData = localStorage.getItem('farmSimulatorSave');
            
            if (savedData) {
                const parsedData = JSON.parse(savedData);
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                gameState.money = parsedData.money || 100;
                gameState.seeds = parsedData.seeds || 10;
                gameState.level = parsedData.level || 1;
                gameState.experience = parsedData.experience || 0;
                gameState.plots = parsedData.plots || 4;
                gameState.upgrades = parsedData.upgrades || [];
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞—Å—Ç–µ–Ω–∏—è
                if (parsedData.plants) {
                    gameState.plants = parsedData.plants.map(plant => {
                        if (!plant) return null;
                        
                        // –ï—Å–ª–∏ —Ä–∞—Å—Ç–µ–Ω–∏–µ –±—ã–ª–æ –ø–æ—Å–∞–∂–µ–Ω–æ, –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º –≤—Ä–µ–º—è –ø–æ—Å–∞–¥–∫–∏
                        if (plant.plantedAt) {
                            const now = Date.now();
                            const elapsed = (now - plant.plantedAt) / 1000;
                            const plantType = plantTypes.find(p => p.id === plant.typeId);
                            const growTime = plantType.growTime * (gameState.upgrades.includes(2) ? 0.9 : 1);
                            
                            if (elapsed >= growTime) {
                                plant.ready = true;
                                plant.progress = 100;
                            } else {
                                plant.ready = false;
                                plant.progress = (elapsed / growTime) * 100;
                                plant.timeLeft = Math.ceil(growTime - elapsed);
                            }
                        }
                        
                        return plant;
                    });
                } else {
                    gameState.plants = Array(gameState.plots).fill(null);
                }
                
                showMessage("–ò–≥—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!", "info");
            } else {
                // –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
                gameState.plants = Array(gameState.plots).fill(null);
            }
        }

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>